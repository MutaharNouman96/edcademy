<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ed-Cademy â€” Student Analytics</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
  <style>
    :root {
      --primary: #6f42c1;
      --primary-dark: #4b2a87;
      --primary-50: #f3e8ff;
      --bg: #f7f7fb;
    }
    body { background: var(--bg); }
    .brand { color: var(--primary); font-weight: 700; }
    .header { position: sticky; top: 0; z-index: 1020; background: #fff; border-bottom: 1px solid rgba(0,0,0,.06); }
    .sidebar { position: sticky; top: 58px; height: calc(100dvh - 58px); overflow-y: auto; background: #fff; border-right: 1px solid rgba(0,0,0,.06); }
    .sidebar .nav-link { color: #4b5563; border-radius: .5rem; }
    .sidebar .nav-link.active { background: var(--primary-50); color: var(--primary-dark); font-weight: 600; }
    .kpi-card { border: 0; border-radius: 16px; box-shadow: 0 6px 24px rgba(0,0,0,.06); }
    .kpi-icon { width: 44px; height: 44px; display:inline-flex; align-items:center; justify-content:center; border-radius:10px; background: var(--primary-50); color: var(--primary); }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header py-2">
    <div class="container-fluid px-4 d-flex justify-content-between align-items-center">
      <a href="edcademy-landing.html" class="brand text-decoration-none">
        <i class="bi bi-mortarboard-fill me-2"></i>Ed-Cademy
      </a>
      <div class="d-flex gap-2">
        <a class="btn btn-sm btn-outline-primary" href="#"><i class="bi bi-chat-dots me-1"></i> Messages</a>
        <div class="dropdown">
          <button class="btn btn-light border dropdown-toggle" data-bs-toggle="dropdown">
            <i class="bi bi-person-circle me-1"></i> Niaz
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="#">Settings</a></li>
            <li><a class="dropdown-item" href="#">Billing</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item text-danger" href="#">Sign out</a></li>
          </ul>
        </div>
      </div>
    </div>
  </header>

  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <aside class="col-12 col-md-3 col-lg-2 sidebar p-3">
        <nav class="nav flex-column gap-1">
          <a class="nav-link" href="edcademy_student_dashboard.html"><i class="bi bi-speedometer2 me-2"></i> Overview</a>
          <a class="nav-link" href="edcademy_student_my_courses.html"><i class="bi bi-journal-richtext me-2"></i> My Courses</a>
          <a class="nav-link active" href="#"><i class="bi bi-graph-up-arrow me-2"></i> Analytics</a>
          <a class="nav-link" href="#"><i class="bi bi-award me-2"></i> Certificates</a>
          <a class="nav-link" href="#"><i class="bi bi-wallet2 me-2"></i> Payments</a>
          <a class="nav-link" href="#"><i class="bi bi-chat-dots me-2"></i> Messages</a>
          <a class="nav-link" href="#"><i class="bi bi-gear me-2"></i> Settings</a>
        </nav>
      </aside>

      <!-- Main -->
      <main class="col-12 col-md-9 col-lg-10 p-4">
        <h2 class="h4 mb-4">Analytics</h2>

        <!-- KPI cards -->
        <div class="row g-3 mb-4">
          <div class="col-6 col-lg-3">
            <div class="card kpi-card p-3">
              <div class="d-flex align-items-center justify-content-between">
                <span class="kpi-icon"><i class="bi bi-journal-richtext"></i></span>
                <span class="small text-muted">Total</span>
              </div>
              <div class="mt-2">
                <h3 id="kpiTotal">0</h3>
                <small class="text-muted">Courses Taken</small>
              </div>
            </div>
          </div>
          <div class="col-6 col-lg-3">
            <div class="card kpi-card p-3">
              <div class="d-flex align-items-center justify-content-between">
                <span class="kpi-icon"><i class="bi bi-check-circle"></i></span>
                <span class="small text-muted">Done</span>
              </div>
              <div class="mt-2">
                <h3 id="kpiCompleted">0</h3>
                <small class="text-muted">Completed</small>
              </div>
            </div>
          </div>
          <div class="col-6 col-lg-3">
            <div class="card kpi-card p-3">
              <div class="d-flex align-items-center justify-content-between">
                <span class="kpi-icon"><i class="bi bi-hourglass-split"></i></span>
                <span class="small text-muted">Active</span>
              </div>
              <div class="mt-2">
                <h3 id="kpiOngoing">0</h3>
                <small class="text-muted">Ongoing Courses</small>
              </div>
            </div>
          </div>
          <div class="col-6 col-lg-3">
            <div class="card kpi-card p-3">
              <div class="d-flex align-items-center justify-content-between">
                <span class="kpi-icon"><i class="bi bi-clock-history"></i></span>
                <span class="small text-muted">Total</span>
              </div>
              <div class="mt-2">
                <h3 id="kpiWatch">0 h</h3>
                <small class="text-muted">Watch Time</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Charts -->
        <div class="row g-3 mb-4">
          <div class="col-lg-8">
            <div class="card p-3">
              <h6 class="mb-2">Course Completion by Course</h6>
              <canvas id="completionChart" height="130"></canvas>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card p-3">
              <h6 class="mb-2">Watch Time (14 days)</h6>
              <canvas id="watchChart" height="160"></canvas>
            </div>
          </div>
        </div>

        <!-- Table -->
        <div class="card p-3">
          <h6 class="mb-2">Course Status</h6>
          <div class="table-responsive">
            <table class="table align-middle">
              <thead>
                <tr>
                  <th>Course</th>
                  <th>Subject</th>
                  <th>Status</th>
                  <th>Progress</th>
                </tr>
              </thead>
              <tbody id="courseTableBody"></tbody>
            </table>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script>
    // Sample student data
    const courses = [
      { title: "Calculus I", subject: "Math", progress: 0.85, hours: 7 },
      { title: "Physics Mechanics", subject: "Physics", progress: 0.4, hours: 3 },
      { title: "Essay Writing", subject: "English", progress: 1.0, hours: 5 },
      { title: "Organic Chemistry", subject: "Chemistry", progress: 0.2, hours: 1.5 },
    ];

    // KPI values
    document.getElementById("kpiTotal").textContent = courses.length;
    const completed = courses.filter(c => c.progress >= 1).length;
    document.getElementById("kpiCompleted").textContent = completed;
    document.getElementById("kpiOngoing").textContent = courses.filter(c => c.progress > 0 && c.progress < 1).length;
    const totalHours = courses.reduce((a,c)=>a+c.hours,0);
    document.getElementById("kpiWatch").textContent = totalHours.toFixed(1) + " h";

    // Table
    const tbody = document.getElementById("courseTableBody");
    tbody.innerHTML = courses.map(c=>`
      <tr>
        <td>${c.title}</td>
        <td>${c.subject}</td>
        <td>${c.progress>=1?'<span class="badge bg-success">Completed</span>':(c.progress>0?'<span class="badge bg-warning text-dark">Ongoing</span>':'<span class="badge bg-secondary">Not Started</span>')}</td>
        <td>${Math.round(c.progress*100)}%</td>
      </tr>
    `).join("");

    // Charts
    const compCtx = document.getElementById("completionChart");
    new Chart(compCtx,{
      type:"bar",
      data:{
        labels:courses.map(c=>c.title),
        datasets:[{ label:"Completion %", data:courses.map(c=>Math.round(c.progress*100)), backgroundColor:"rgba(111,66,193,.7)" }]
      },
      options:{responsive:true, plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true, max:100}}}
    });

    const watchCtx = document.getElementById("watchChart");
    const labels = Array.from({length:14},(_,i)=>`D-${14-i}`);
    const mins = labels.map(()=> Math.floor(10+Math.random()*40));
    new Chart(watchCtx,{
      type:"line",
      data:{ labels, datasets:[{ label:"Minutes", data:mins, borderColor:"#6f42c1", fill:true, backgroundColor:"rgba(111,66,193,.1)", tension:.3 }] },
      options:{responsive:true, plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true}}}
    });
  </script>
</body>
</html>
